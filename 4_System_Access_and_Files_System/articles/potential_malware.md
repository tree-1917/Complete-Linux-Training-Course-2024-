# How to Detect and Remove Malware from Your Linux System ğŸ§ğŸ›¡ï¸

### Step 1: Check Recently Installed Packages ğŸ“¦

1. **List Recently Installed Packages Using `dpkg` (for Debian-based systems like Ubuntu, Pop!\_OS)**

   ```bash
   grep " install " /var/log/dpkg.log
   ```

   This command will list all the packages that were installed recently.

2. **List Recently Installed Packages Using `rpm` (for Red Hat-based systems like Fedora, CentOS)**
   ```bash
   sudo rpm -qa --last
   ```

### Step 2: Check System Logs for Unusual Activity ğŸ“œ

1. **Check Auth Logs for Unauthorized Access**

   ```bash
   sudo grep 'sshd' /var/log/auth.log
   ```

2. **Check System Logs for Suspicious Activity**
   ```bash
   sudo grep 'sudo' /var/log/syslog
   ```

### Step 3: Use Malware Scanning Tools ğŸ›¡ï¸

1. **Install and Run `chkrootkit`**

   ```bash
   sudo apt-get install chkrootkit
   sudo chkrootkit
   ```

   This tool checks for signs of a rootkit on your system.

2. **Install and Run `rkhunter`**

   ```bash
   sudo apt-get install rkhunter
   sudo rkhunter --check
   ```

   `rkhunter` scans for rootkits, backdoors, and local exploits.

### Step 4: Check for Suspicious Processes âš™ï¸

1. **List All Running Processes**

   ```bash
   ps aux
   ```

   Look for processes that seem unfamiliar or suspicious.

2. **Check Network Connections**

   ```bash
   netstat -tulnp
   ```

   This command lists all listening ports and the associated programs.

### Step 5: Check for New Users or Groups ğŸ‘¤

1. **List All Users**

   ```bash
   cat /etc/passwd
   ```

   Look for any new or unfamiliar user accounts.

2. **List All Groups**

   ```bash
   cat /etc/group
   ```

   Look for any new or unfamiliar groups.

### Step 6: Use a File Integrity Checker ğŸ—‚ï¸

1. **Install and Configure `AIDE` (Advanced Intrusion Detection Environment)**

   ```bash
   sudo apt-get install aide
   sudo aideinit
   ```

   This will create a baseline database of your system's files.

2. **Check File Changes with `AIDE`**

   ```bash
   sudo aide --check
   ```

   This compares the current state of your system with the baseline database.

### Step 7: Remove the Malware ğŸ—‘ï¸

1. **Identify the Malware**
   Based on the information from the previous steps, identify the suspicious files or processes.

2. **Stop and Remove the Malware**

   ```bash
   sudo systemctl stop <service_name>
   sudo apt-get remove --purge <package_name>
   ```

3. **Delete Suspicious Files**
   ```bash
   sudo rm -rf /path/to/suspicious/file
   ```

### Step 8: Secure Your System ğŸ”’

1. **Update All Packages**

   ```bash
   sudo apt-get update && sudo apt-get upgrade
   ```

2. **Change All Passwords**
   Ensure all passwords are strong and unique.

3. **Install and Configure a Firewall**
   ```bash
   sudo apt-get install ufw
   sudo ufw enable
   sudo ufw default deny incoming
   sudo ufw default allow outgoing
   ```

By following these steps, you can thoroughly scan your Linux system for newly installed software and potential malware, and take appropriate actions to secure your system.
